{% extends 'quotes/base.html' %}

{% block main_content %}
    <section>
        <div class="container">
            <div class="row swap-div-mobile">
                <div class="col-lg-8">
                    <h1 class="font-wight-600 mb-3 font-xl responsive-font-xl heading-slogan">Find Affordable Health quotes&nbsp;<br>Thatâ€™s Right for You</h1>
                    <h2 class="font-wight-600 mb-4 font-md heading-mini-slogan">Instantly Compare Over 4,000<br>Insurance Plans</h2>

                    <div id="find-plans" class="mb-5">
                        <form novalidate action="{% url 'quotes:survey_members' %}" method="post" class="border-md border-0 border-tertiary rounded"
                            style="border-right-color: transparent !important;"> {# hack for bootstrap 1px error #}
                            {% csrf_token %}
                            <div class="row">
                                <div class="col-md-4 border-md-right border-0 border-tertiary">
                                    <div class="py-1 pr-md-0 pl-md-3 px-3 mb-md-0 mb-3 border-md-0 border border-tertiary rounded">
                                        <div class="text-capitalize text-secondary font-wight-600 quote-info-label">I'm looking For:</div>
                                        <div class="text-capitalize font-md text-black quote-name">Health Insurance</div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="py-1 px-md-0 px-3 mb-md-0 mb-3 border-md-0 border border-tertiary rounded">
                                        <label for="home-zip-code" class="text-capitalize text-secondary font-wight-600 mb-0 quote-info-label">Zip Code</label>
                                        <zip-code></zip-code>
                                        <div class="home-zc-err"></div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="h-100 rounded" style="min-height: 50px;">
                                        <button class="text-capitalize rounded-0 btn btn-tertiary w-100 h-100 font-weight-bold font-md">Find plans</button>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>

                <div class="col-lg-4 text-center">
                    <div class="position-absolute d-none d-lg-block rounded" id="separator"></div>
                    <div class="h-100 d-flex align-items-center justify-content-center">
                        <div class="">
                            <a href="#" class="btn btn-primary font-md font-wight-600 btn-lg">Assisted by Agent?</a>
                            <p class="small text-secondary pt-2">If you're being assisted by an Agent, click here</p>
                        </div>
                    </div>
                    <hr class="mb-5 d-block d-lg-none">
                </div>
            </div>
        </div>
    </section>
{% endblock %}


{% block bottom_js %}
    <script type="text/javascript">
        const marker = {
            success: '<svg xmlns="http://www.w3.org/2000/svg" class="success" viewBox="0 0 24 24">' +
                        '<path d="M20.285 2l-11.285 11.567-5.286-5.011-3.714 3.716 9 8.728 15-15.285z"/></svg>',
            error: `<svg xmlns="http://www.w3.org/2000/svg" class="danger" viewBox="0 0 24 24">
                        <path d="M24 20.188l-8.315-8.209 8.2-8.282-3.697-3.697-8.212 8.318-8.31-8.203-3.666 3.666 8.321 8.24-8.206 8.313 3.666 3.666 8.237-8.318 8.285 8.203z"/>
                    </svg>`,
        }
        Vue.component('zip-code', {
            delimiters: ['[[', ']]'],
            data: function () {
                return {
                    placeholder: 'Enter Zip Code',
                    zip_code: '',
                    current_marker: undefined,
                }
            },
            methods: {
                validate_zip: function (e) {
                    if (e.keyCode > 31 && (e.keyCode < 48 || e.keyCode > 57)) e.preventDefault();   // prevent if not number
                    else return true;
                }
            },
            watch: {
                zip_code: function () {
                    if(this.zip_code.length === 5){
                        this.current_marker = marker.success;
                    } else {
                        this.current_marker = marker.error;
                    }
                }
            },
            template: `<div class="position-relative">
                <input type="text" id="home-zip-code"
                        class="font-md border-0 outline-0 w-100"
                        :placeholder="placeholder" v-model="zip_code" maxlength="5" v-on:keypress="validate_zip($event)">
                <div class="position-absolute vertical-center" style="left:99%" v-html="current_marker"></div>
            </div>`,
        })
    </script>
{% endblock %}
